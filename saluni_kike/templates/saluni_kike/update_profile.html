{% extends "base.html" %}
{% block content %}
<h1>Update Profile ya Saluni</h1>

<form method="post" id="salon-update-form">
  {% csrf_token %}
  {{ form.non_field_errors }}

  {% for field in form %}
    {% if field.name != 'latitude' and field.name != 'longitude' %}
      <div>
        <label for="{{ field.id_for_label }}">{{ field.label }}</label><br>
        {{ field.errors }}
        {{ field }}
      </div>
    {% endif %}
  {% endfor %}

  <!-- Hidden fields rendered manually -->
  <div style="display:none;">
      {{ form.latitude }}
      {{ form.longitude }}
  </div>

  <div>
    <button type="submit">Hifadhi Taarifa</button>
  </div>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const latInput = document.getElementById('id_latitude');
    const lngInput = document.getElementById('id_longitude');

    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            function(position) {
                if (latInput) latInput.value = position.coords.latitude.toFixed(6);
                if (lngInput) lngInput.value = position.coords.longitude.toFixed(6);
            },
            function(error) {
                console.log('Geolocation not available or denied.');
            },
            { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 }
        );
    }
});
</script>
{% endblock %}
